{"version":3,"sources":["../src/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["// import * as Promise from \"bluebird\";\r\nimport * as fs from \"fs\";\r\n\r\nimport {Content, Input, Output, Parser} from \"parsque-api\";\r\n\r\nconst FILES_PATH = \"./files/\";\r\nconst FILE_1_PATH = FILES_PATH + \"file_1.txt\";\r\nconst FILE_2_PATH = FILES_PATH + \"file_2.txt\";\r\nconst FILE_3_PATH = FILES_PATH + \"file_3.txt\";\r\n\r\nclass FileInput extends Input {\r\n    path: string;\r\n\r\n    file: FileInput;\r\n    files: FileInput[];\r\n}\r\n\r\nclass FileOutput extends Output {\r\n    number: number;\r\n    string: string;\r\n\r\n    file: FileOutput;\r\n    files: FileOutput[];\r\n}\r\n\r\nclass FileContent extends Content {\r\n    lines: string[];\r\n}\r\n\r\nclass FileParser extends Parser {\r\n    public constructor(private path: string = \"\") {\r\n        super();\r\n    }\r\n\r\n    protected createInput(): Promise<Input> {\r\n        return new Promise<Input>(resolve => {\r\n            let input: FileInput = new FileInput();\r\n            input.path = this.path;\r\n\r\n            resolve(input);\r\n        });\r\n    }\r\n\r\n    protected inputCreated(): Promise<void> {\r\n        return new Promise<void>(resolve => {\r\n            let input: FileInput = this.input as FileInput;\r\n\r\n            let childInput: FileInput = new FileInput();\r\n            childInput.path = FILE_2_PATH;\r\n            input.file = childInput;\r\n\r\n            let childInputs: FileInput[] = [];\r\n\r\n            for (let path of [FILE_1_PATH, FILE_2_PATH, FILE_3_PATH]) {\r\n                let childInput: FileInput = new FileInput();\r\n                childInput.path = path;\r\n                childInputs.push(childInput);\r\n            }\r\n\r\n            input.files = childInputs;\r\n\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    protected createOutput(): Promise<Output> {\r\n        return new Promise<Output>(resolve => {\r\n            resolve(new FileOutput());\r\n        });\r\n    }\r\n\r\n    protected createContent(): Promise<Content> {\r\n        return new Promise<Content>((resolve, reject) => {\r\n            let content: FileContent = new FileContent();\r\n\r\n            fs.readFile((this.input as FileInput).path, \"utf-8\", (err, data) => {\r\n                if (err) {\r\n                    reject(err);\r\n                    return;\r\n                }\r\n\r\n                content.lines = data.split(/\\s+/);\r\n\r\n                resolve(content);\r\n            });\r\n        });\r\n    }\r\n\r\n    create(inputFactory?: (parser: Parser) => Promise<Input>,\r\n           outputFactory?: (parser: Parser) => Promise<Output>,\r\n           contentFactory?: (parser: Parser) => Promise<Content>): Promise<FileParser> {\r\n        return super.create(inputFactory, outputFactory, contentFactory) as Promise<FileParser>;\r\n    }\r\n\r\n    public parseNumber(): Promise<FileParser> {\r\n        return this.parseValue(\"number\", parser => new Promise<any>(resolve => {\r\n            resolve(parseInt((this.content as FileContent).lines[0]));\r\n        })) as Promise<FileParser>;\r\n    }\r\n\r\n    public parseString(): Promise<FileParser> {\r\n        return this.parseValue(\"string\", parser => new Promise<any>(resolve => {\r\n            resolve(this.content.lines[1]);\r\n        })) as Promise<FileParser>;\r\n    }\r\n}\r\n\r\nnew FileParser().create()\r\n    .then(parser => parser.parseNumber())\r\n    .then(parser => parser.parseString())\r\n    .then(parser => {\r\n        console.log(parser.output);\r\n    })\r\n    .catch(error => {\r\n        console.log(error);\r\n    });\r\n"]}